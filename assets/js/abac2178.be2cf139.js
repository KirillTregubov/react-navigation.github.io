"use strict";(self.webpackChunkreact_navigation_website_next=self.webpackChunkreact_navigation_website_next||[]).push([[90975],{55554:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>u,default:()=>g,frontMatter:()=>r,metadata:()=>c,toc:()=>d});var a=n(85893),o=n(11151),i=n(74866),s=n(85162);const r={id:"use-navigation-state",title:"useNavigationState",sidebar_label:"useNavigationState"},u=void 0,c={id:"use-navigation-state",title:"useNavigationState",description:"useNavigationState is a hook which gives access to the navigation state of the navigator which contains the screen. It's useful in rare cases where you want to render something based on the navigation state.",source:"@site/versioned_docs/version-7.x/use-navigation-state.md",sourceDirName:".",slug:"/use-navigation-state",permalink:"/docs/7.x/use-navigation-state",draft:!1,unlisted:!1,editUrl:"https://github.com/react-navigation/react-navigation.github.io/edit/main/versioned_docs/version-7.x/use-navigation-state.md",tags:[],version:"7.x",frontMatter:{id:"use-navigation-state",title:"useNavigationState",sidebar_label:"useNavigationState"},sidebar:"docs",previous:{title:"useRoute",permalink:"/docs/7.x/use-route"},next:{title:"useFocusEffect",permalink:"/docs/7.x/use-focus-effect"}},l={},d=[{value:"How is <code>useNavigationState</code> different from <code>navigation.getState()</code>?",id:"how-is-usenavigationstate-different-from-navigationgetstate",level:2},{value:"Using with class component",id:"using-with-class-component",level:2}];function v(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",p:"p",pre:"pre",...(0,o.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.code,{children:"useNavigationState"})," is a hook which gives access to the ",(0,a.jsx)(t.a,{href:"/docs/7.x/navigation-state",children:"navigation state"})," of the navigator which contains the screen. It's useful in rare cases where you want to render something based on the navigation state."]}),"\n",(0,a.jsx)(t.admonition,{type:"warning",children:(0,a.jsxs)(t.p,{children:["Consider the navigator's state object to be internal and subject to change in a minor release. Avoid using properties from the ",(0,a.jsx)(t.a,{href:"/docs/7.x/navigation-state",children:"navigation state"})," state object except ",(0,a.jsx)(t.code,{children:"index"})," and ",(0,a.jsx)(t.code,{children:"routes"}),", unless you really need it. If there is some functionality you cannot achieve without relying on the structure of the state object, please open an issue."]})}),"\n",(0,a.jsxs)(t.p,{children:["It takes a selector function as an argument. The selector will receive the full ",(0,a.jsx)(t.a,{href:"/docs/7.x/navigation-state",children:"navigation state"})," and can return a specific value from the state:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-js",children:"const index = useNavigationState((state) => state.index);\n"})}),"\n",(0,a.jsx)(t.p,{children:"The selector function helps to reduce unnecessary re-renders, so your screen will re-render only when that's something you care about. If you actually need the whole state object, you can do this explicitly:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-js",children:"const state = useNavigationState((state) => state);\n"})}),"\n",(0,a.jsx)(t.admonition,{type:"warning",children:(0,a.jsx)(t.p,{children:"This hook is useful for advanced cases and it's easy to introduce performance issues if you're not careful. For most of the cases, you don't need the navigator's state."})}),"\n",(0,a.jsxs)(t.h2,{id:"how-is-usenavigationstate-different-from-navigationgetstate",children:["How is ",(0,a.jsx)(t.code,{children:"useNavigationState"})," different from ",(0,a.jsx)(t.code,{children:"navigation.getState()"}),"?"]}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:"navigation.getState()"})," function also returns the current ",(0,a.jsx)(t.a,{href:"/docs/7.x/navigation-state",children:"navigation state"}),". The main difference is that the ",(0,a.jsx)(t.code,{children:"useNavigationState"})," hook will trigger a re-render when values change, while ",(0,a.jsx)(t.code,{children:"navigation.getState()"})," won't. For example, the following code will be incorrect:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-js",children:"function Profile() {\n  const routesLength = navigation.getState().routes.length; // Don't do this\n\n  return <Text>Number of routes: {routesLength}</Text>;\n}\n"})}),"\n",(0,a.jsx)(t.p,{children:"In this example, even if you push a new screen, this text won't update. If you use the hook, it'll work as expected:"}),"\n",(0,a.jsxs)(i.Z,{groupId:"config",queryString:"config",children:[(0,a.jsx)(s.Z,{value:"static",label:"Static",default:!0,children:(0,a.jsx)(t.pre,{"data-name":"useNavigation hook","data-snack":"true",children:(0,a.jsx)(t.code,{className:"language-js",metastring:'name="useNavigation hook" snack',children:"import * as React from 'react';\nimport Button from '@react-navigation/elements';\nimport { View, Text } from 'react-native';\nimport {\n  createStaticNavigation,\n  useNavigation,\n  useRoute,\n} from '@react-navigation/native';\nimport { createNativeStackNavigator } from '@react-navigation/native-stack';\n// codeblock-focus-start\nimport { useNavigationState } from '@react-navigation/native';\n\nfunction useIsFirstRouteInParent() {\n  const route = useRoute();\n  const isFirstRouteInParent = useNavigationState(\n    (state) => state.routes[0].key === route.key\n  );\n\n  return isFirstRouteInParent;\n}\n\nfunction usePreviousRouteName() {\n  return useNavigationState((state) =>\n    state.routes[state.index - 1]?.name\n      ? state.routes[state.index - 1].name\n      : 'None'\n  );\n}\n// codeblock-focus-end\n\nfunction HomeScreen() {\n  const navigation = useNavigation();\n  const isFirstRoute = useIsFirstRouteInParent();\n  const previousRouteName = usePreviousRouteName();\n  return (\n    <View style={{ flex: 1, alignItems: 'center', justifyContent: 'center' }}>\n      <Text>It is {isFirstRoute ? '' : 'not '}first route in navigator</Text>\n      <Text>Previous route name: {previousRouteName}</Text>\n\n      <Button onPress={() => navigation.navigate('Profile')}>\n        Go to Profile\n      </Button>\n    </View>\n  );\n}\n\nfunction ProfileScreen() {\n  const navigation = useNavigation();\n  const isFirstRoute = useIsFirstRouteInParent();\n  const previousRouteName = usePreviousRouteName();\n  return (\n    <View style={{ flex: 1, alignItems: 'center', justifyContent: 'center' }}>\n      <Text>It is {isFirstRoute ? '' : 'not '}first route in navigator</Text>\n      <Text>Previous route name: {previousRouteName}</Text>\n      <Button onPress={() => navigation.navigate('Settings')}>\n        Go to Settings\n      </Button>\n      <Button onPress={() => navigation.goBack()}>Go back</Button>\n    </View>\n  );\n}\n\nfunction SettingsScreen() {\n  const navigation = useNavigation();\n  const isFirstRoute = useIsFirstRouteInParent();\n  const previousRouteName = usePreviousRouteName();\n  return (\n    <View style={{ flex: 1, alignItems: 'center', justifyContent: 'center' }}>\n      <Text>It is {isFirstRoute ? '' : 'not '}first route in navigator</Text>\n      <Text>Previous route name: {previousRouteName}</Text>\n      <Button onPress={() => navigation.goBack()}>Go back</Button>\n    </View>\n  );\n}\n\nconst Stack = createNativeStackNavigator({\n  screens: {\n    Home: HomeScreen,\n    Profile: ProfileScreen,\n    Settings: SettingsScreen,\n  },\n});\n\nconst Navigation = createStaticNavigation(Stack);\n\nexport default function App() {\n  return <Navigation />;\n}\n"})})}),(0,a.jsx)(s.Z,{value:"dynamic",label:"Dynamic",children:(0,a.jsx)(t.pre,{"data-name":"useNavigationState hook","data-snack":"true",children:(0,a.jsx)(t.code,{className:"language-js",metastring:'name="useNavigationState hook" snack',children:"import * as React from 'react';\nimport Button from '@react-navigation/elements';\nimport { View, Text } from 'react-native';\nimport {\n  NavigationContainer,\n  useRoute,\n  useNavigation,\n} from '@react-navigation/native';\nimport { createNativeStackNavigator } from '@react-navigation/native-stack';\n\n// codeblock-focus-start\nimport { useNavigationState } from '@react-navigation/native';\n\nfunction useIsFirstRouteInParent() {\n  const route = useRoute();\n  const isFirstRouteInParent = useNavigationState(\n    (state) => state.routes[0].key === route.key\n  );\n\n  return isFirstRouteInParent;\n}\n\nfunction usePreviousRouteName() {\n  return useNavigationState((state) =>\n    state.routes[state.index - 1]?.name\n      ? state.routes[state.index - 1].name\n      : 'None'\n  );\n}\n// codeblock-focus-end\n\nfunction HomeScreen({ navigation }) {\n  const isFirstRoute = useIsFirstRouteInParent();\n  const previousRouteName = usePreviousRouteName();\n  return (\n    <View style={{ flex: 1, alignItems: 'center', justifyContent: 'center' }}>\n      <Text>It is {isFirstRoute ? '' : 'not '}first route in navigator</Text>\n      <Text>Previous route name: {previousRouteName}</Text>\n\n      <Button onPress={() => navigation.navigate('Profile')}>\n        Go to Profile\n      </Button>\n    </View>\n  );\n}\n\nfunction ProfileScreen({ navigation }) {\n  const isFirstRoute = useIsFirstRouteInParent();\n  const previousRouteName = usePreviousRouteName();\n  return (\n    <View style={{ flex: 1, alignItems: 'center', justifyContent: 'center' }}>\n      <Text>It is {isFirstRoute ? '' : 'not '}first route in navigator</Text>\n      <Text>Previous route name: {previousRouteName}</Text>\n      <Button onPress={() => navigation.navigate('Settings')}>\n        Go to Settings\n      </Button>\n      <Button onPress={() => navigation.goBack()}>Go back</Button>\n    </View>\n  );\n}\n\nfunction SettingsScreen({ navigation }) {\n  const isFirstRoute = useIsFirstRouteInParent();\n  const previousRouteName = usePreviousRouteName();\n  return (\n    <View style={{ flex: 1, alignItems: 'center', justifyContent: 'center' }}>\n      <Text>It is {isFirstRoute ? '' : 'not '}first route in navigator</Text>\n      <Text>Previous route name: {previousRouteName}</Text>\n      <Button onPress={() => navigation.goBack()}>Go back</Button>\n    </View>\n  );\n}\n\nconst Stack = createNativeStackNavigator();\n\nfunction MyStack() {\n  return (\n    <Stack.Navigator>\n      <Stack.Screen name=\"Home\" component={HomeScreen} />\n      <Stack.Screen name=\"Profile\" component={ProfileScreen} />\n      <Stack.Screen name=\"Settings\" component={SettingsScreen} />\n    </Stack.Navigator>\n  );\n}\n\nexport default function App() {\n  return (\n    <NavigationContainer>\n      <MyStack />\n    </NavigationContainer>\n  );\n}\n"})})})]}),"\n",(0,a.jsxs)(t.p,{children:["So when do you use ",(0,a.jsx)(t.code,{children:"navigation.getState()"}),"? It's mostly useful within event listeners where you don't care about what's rendered. In most cases, using the hook should be preferred."]}),"\n",(0,a.jsx)(t.h2,{id:"using-with-class-component",children:"Using with class component"}),"\n",(0,a.jsx)(t.p,{children:"You can wrap your class component in a function component to use the hook:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-js",children:"class Profile extends React.Component {\n  render() {\n    // Get it from props\n    const { routesLength } = this.props;\n  }\n}\n\n// Wrap and export\nexport default function (props) {\n  const routesLength = useNavigationState((state) => state.routes.length);\n\n  return <Profile {...props} routesLength={routesLength} />;\n}\n"})})]})}function g(e={}){const{wrapper:t}={...(0,o.a)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(v,{...e})}):v(e)}},85162:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var a=n(86010);const o={tabItem:"tabItem_Ymn6"};var i=n(85893);function s(e){let{children:t,hidden:n,className:s}=e;return(0,i.jsx)("div",{role:"tabpanel",className:(0,a.Z)(o.tabItem,s),hidden:n,children:t})}},74866:(e,t,n)=>{n.d(t,{Z:()=>w});var a=n(67294),o=n(86010),i=n(12466),s=n(16550),r=n(20469),u=n(91980),c=n(67392),l=n(50012);function d(e){var t,n;return null!=(t=null==(n=a.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})))?void 0:n.filter(Boolean))?t:[]}function v(e){const{values:t,children:n}=e;return(0,a.useMemo)((()=>{const e=null!=t?t:function(e){return d(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:o}}=e;return{value:t,label:n,attributes:a,default:o}}))}(n);return function(e){const t=(0,c.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error('Docusaurus error: Duplicate values "'+t.map((e=>e.value)).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e}),[t,n])}function g(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function h(e){let{queryString:t=!1,groupId:n}=e;const o=(0,s.k6)(),i=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=n?n:null}({queryString:t,groupId:n});return[(0,u._X)(i),(0,a.useCallback)((e=>{if(!i)return;const t=new URLSearchParams(o.location.search);t.set(i,e),o.replace({...o.location,search:t.toString()})}),[i,o])]}function f(e){const{defaultValue:t,queryString:n=!1,groupId:o}=e,i=v(e),[s,u]=(0,a.useState)((()=>function(e){var t;let{defaultValue:n,tabValues:a}=e;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!g({value:n,tabValues:a}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+n+'" but none of its children has the corresponding value. Available values are: '+a.map((e=>e.value)).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return n}const o=null!=(t=a.find((e=>e.default)))?t:a[0];if(!o)throw new Error("Unexpected error: 0 tabValues");return o.value}({defaultValue:t,tabValues:i}))),[c,d]=h({queryString:n,groupId:o}),[f,m]=function(e){let{groupId:t}=e;const n=function(e){return e?"docusaurus.tab."+e:null}(t),[o,i]=(0,l.Nk)(n);return[o,(0,a.useCallback)((e=>{n&&i.set(e)}),[n,i])]}({groupId:o}),p=(()=>{const e=null!=c?c:f;return g({value:e,tabValues:i})?e:null})();(0,r.Z)((()=>{p&&u(p)}),[p]);return{selectedValue:s,selectValue:(0,a.useCallback)((e=>{if(!g({value:e,tabValues:i}))throw new Error("Can't select invalid tab value="+e);u(e),d(e),m(e)}),[d,m,i]),tabValues:i}}var m=n(72389);const p={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=n(85893);function b(e){let{className:t,block:n,selectedValue:a,selectValue:s,tabValues:r}=e;const u=[],{blockElementScrollPositionUntilNextRender:c}=(0,i.o5)(),l=e=>{const t=e.currentTarget,n=u.indexOf(t),o=r[n].value;o!==a&&(c(t),s(o))},d=e=>{var t;let n=null;switch(e.key){case"Enter":l(e);break;case"ArrowRight":{var a;const t=u.indexOf(e.currentTarget)+1;n=null!=(a=u[t])?a:u[0];break}case"ArrowLeft":{var o;const t=u.indexOf(e.currentTarget)-1;n=null!=(o=u[t])?o:u[u.length-1];break}}null==(t=n)||t.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":n},t),children:r.map((e=>{let{value:t,label:n,attributes:i}=e;return(0,x.jsx)("li",{role:"tab",tabIndex:a===t?0:-1,"aria-selected":a===t,ref:e=>u.push(e),onKeyDown:d,onClick:l,...i,className:(0,o.Z)("tabs__item",p.tabItem,null==i?void 0:i.className,{"tabs__item--active":a===t}),children:null!=n?n:t},t)}))})}function N(e){let{lazy:t,children:n,selectedValue:o}=e;const i=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=i.find((e=>e.props.value===o));return e?(0,a.cloneElement)(e,{className:"margin-top--md"}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:i.map(((e,t)=>(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==o})))})}function S(e){const t=f(e);return(0,x.jsxs)("div",{className:(0,o.Z)("tabs-container",p.tabList),children:[(0,x.jsx)(b,{...e,...t}),(0,x.jsx)(N,{...e,...t})]})}function w(e){const t=(0,m.Z)();return(0,x.jsx)(S,{...e,children:d(e.children)},String(t))}},11151:(e,t,n)=>{n.d(t,{Z:()=>r,a:()=>s});var a=n(67294);const o={},i=a.createContext(o);function s(e){const t=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),a.createElement(i.Provider,{value:t},e.children)}}}]);